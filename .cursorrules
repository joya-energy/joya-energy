# =========================
# JOYA PROJECT – CURSOR RULES
# =========================

project:
  name: JOYA
  stack: MEAN (MongoDB, Express, Angular, Node)
  language:
    backend: TypeScript
    frontend: JavaScript/TypeScript
  architecture: Clean Architecture
  principles:
    - Clean Code
    - SOLID
    - DRY
    - KISS
    - Separation of Concerns
  monorepo: true
  backendRoot: packages/backend
  frontendRoot: packages/frontend

# === GENERAL CODING STYLE ===
style:
  - Readability over cleverness.
  - Functions are small and single-purpose (~20 lines max).
  - Prefer early returns; avoid deep nesting.
  - Descriptive names; no abbreviations.
  - No magic values → use constants or enums.
  - Utilities must be pure.
  - Ordered imports: external → internal → relative.
  - No commented-out code.
  - Always handle errors explicitly.
  - Never use "any" or "unknown".

# === BACKEND RULES ===
backend:
  structure:
    modules: "Business logic (services, use-cases)"
    interfaces: "Controllers, routes, request validation"
    infrastructure: "Database + external API clients"
    domain: "Entities and core abstractions"
    middlewares: "Express middlewares only"
    common: "Shared helpers: constants, logging, errors"
    utils: "Stateless general helpers"
    tests: "Mirrors folder tree"

  guidelines:
    - Business logic never inside controllers.
    - Validation in interfaces layer only.
    - Use dependency inversion everywhere.
    - async/await only.
    - Each module exposes a clean API surface via index.ts.

  code-style:
    - Strong typing consistently.
    - Never use "any" or "unknown".
    - Export only necessary elements.
    - Prefer custom error classes.
    - Log contextual information, not raw objects.

# === FRONTEND (ANGULAR v20+) ===
frontend:
  typescript:
    - Strict typing always.
    - Prefer inference when obvious.
    - Never use "any" or "unknown".

  angular:
    - Use standalone components (default in v20+).
    - Use signals for state.
    - Lazy-load feature routes.
    - Avoid @HostBinding / @HostListener; use host: {} in decorator.
    - Use NgOptimizedImage for non-base64 images.
    - Must satisfy AXE and WCAG AA.

  components:
    - Small, single responsibility.
    - Use input(), output(), computed().
    - ChangeDetection: OnPush.
    - Inline templates preferred for small components.
    - Use class/style bindings instead of ngClass/ngStyle.
    - Relative paths for HTML/CSS files.

  state:
    - Use signals for local state.
    - Use computed() for derived state.
    - Use update() / set(), never mutate().

  templates:
    - Keep logic minimal.
    - Use @if, @for, @switch.
    - No arrow functions.
    - Do not rely on globals like new Date().

  services:
    - Single responsibility.
    - providedIn: "root".
    - Use inject() over constructor injection.

# === TESTING ===
testing:
  - Jest for backend.
  - Tests mirror folder structure.
  - Filename: "<file>.spec.ts".
  - One behavior per test.
  - Test edge cases and failure paths.

# === LINTING ===
linting:
  - Prettier.
  - TS-friendly rules only.
  - 2-space indentation.
  - No console.log in production (use logger).

# === GIT HYGIENE ===
git:
  - Conventional commits.
  - Never commit .env or secrets.
  - PRs must have meaningful descriptions.
  - Branches small and focused.

# === DOCUMENTATION ===
docs:
  - Each module includes a README.md.
  - JSDoc only for exported functions or complex logic.
  - Architecture decisions in /docs/architecture.md.

# === CURSOR AI BEHAVIOR ===
cursor:
  - Respect folder boundaries strictly.
  - Default domain logic to src/modules.
  - Never generate into dist/ or node_modules/.
  - Auto-generate tests and docs when asked.
  - Suggest refactors aligned with SOLID + Clean Architecture.
