# =========================
# CURSOR RULES FOR JOYA PROJECT (MERN)
# =========================

# === GLOBAL CONTEXT ===
project:
  name: JOYA
  stack: MERN (MongoDB, Express, React, Node.js)
  language: TypeScript for backend, JavaScript/TypeScript for frontend
  architecture: Clean Architecture
  principles: Clean Code (Robert C. Martin), SOLID, DRY, KISS, Separation of Concerns
  monorepo: true
  backendRoot: packages/backend
  frontendRoot: packages/frontend

# === GENERAL CODING STYLE ===
rules:
  - Always prefer readability over cleverness.
  - Functions should do one thing only and be small (max ~20 lines ideally).
  - Avoid deeply nested logic. Prefer early returns.
  - Use clear, descriptive variable and function names (no abbreviations).
  - No magic numbers or strings — move them to constants or enums.
  - Avoid side effects in utility functions.
  - Keep imports clean and ordered: external → internal → relative paths.
  - Never commit commented-out code.
  - Use consistent error handling; no silent failures.

# === BACKEND RULES ===
backend:
  - Folder `src/modules` contains feature-specific business logic.
  - Folder `src/interfaces` contains controllers, routes, and request validation.
  - Folder `src/infrastructure` (if created later) handles database, external APIs, etc.
  - Folder `src/domain` (if added) contains entities and core logic.
  - Folder `src/common` holds shared helpers (logging, error types, constants).
  - Folder `src/middlewares` should contain only Express middlewares.
  - Folder `src/utils` for general-purpose stateless functions.
  - Tests live in `src/tests` and should mirror the folder structure of `src`.

  coding-guidelines:
    - Use dependency inversion: high-level modules must not depend on low-level details.
    - Avoid business logic in controllers or routes — keep it in services/modules.
    - Validation happens at the interface level.
    - Use async/await consistently; avoid mixing with `.then()`.
    - Each module exports a clear API surface (index.ts).

  code-style:
    - Use TypeScript types or interfaces consistently.
    - Export only what’s necessary (avoid `export *`).
    - Log meaningful context, not raw errors.
    - Prefer custom error classes in `src/errors`.

# === FRONTEND RULES (if added later) ===
frontend:
  - Use functional React components only.
  - Keep components pure and stateless when possible.
  - Move business logic to hooks or services, not inside components.
  - Use TailwindCSS for UI, avoid inline styles.
  - Folder structure should separate UI, state, and logic clearly.
  - Don’t let UI components depend on API logic directly.

# === TESTING ===
testing:
  - Write unit tests for critical modules and utils.
  - Use Jest for backend testing.
  - Naming convention: `<filename>.spec.ts`
  - Each test should verify one behavior.
  - Prefer descriptive test names (“should return 404 if user not found”).
  - Test edge cases and expected failures.

# === ESLINT / CODE QUALITY ===
eslint:
  - Follow Airbnb + Prettier.
  - Disable rules that conflict with TypeScript.
  - Enforce 2-space indentation.
  - Avoid console.log in production code (use logger).

# === GIT / PROJECT HYGIENE ===
git:
  - Commit messages should follow Conventional Commits (`feat:`, `fix:`, `chore:`, `refactor:`).
  - Never commit `.env` or credentials.
  - Always include a meaningful PR description.
  - Keep branches small and focused.

# === DOCUMENTATION & COMMENTS ===
documentation:
  - Each module must have a brief `README.md` explaining its purpose.
  - Use JSDoc-style comments for exported functions or complex logic.
  - Avoid redundant comments (“increment counter” for `count++`).
  - Document architectural decisions in a `/docs/architecture.md` file.

# === AI (Cursor) BEHAVIOR ===
cursor:
  - Always respect the folder boundaries defined above.
  - When generating code, use Clean Architecture layering.
  - Avoid generating code in `dist/` or `node_modules/`.
  - When unsure about structure, default to `src/modules` for domain logic.
  - Prefer writing tests and docs automatically if asked.
  - Suggest refactors aligned with SOLID and readability improvements.
