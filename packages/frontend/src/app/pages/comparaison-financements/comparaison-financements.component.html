<div class="financing-page">
  <!-- Hero Section -->
  <section class="financing-hero">
    <div class="container">
      <div class="hero-content">
        <h1 class="text-display-section color-text-primary">
          Passez au <span class="highlight">solaire</span><br>
          sans aucun investissement initial
        </h1>
        <p class="hero-subtitle color-text-secondary">
          Comparez toutes les solutions de financement sur 7 ans et découvrez l'impact réel sur votre trésorerie mensuelle.
        </p>
        
        <div class="hero-stats">
          <div class="stat-item">
            <div class="stat-value">0€</div>
            <div class="stat-label">d'investissement</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">-40%</div>
            <div class="stat-label">sur la facture</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">100%</div>
            <div class="stat-label">financé</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Calculator Form -->
  <section class="calculator-section">
    <div class="container">
      <div class="section-header">
        <span class="section-label">SIMULATEUR</span>
        <h2 class="text-heading-h1 color-text-primary">
          Estimez votre potentiel solaire
        </h2>
        <p class="color-text-secondary">
          Entrez les informations de votre projet pour comparer les solutions de financement
        </p>
      </div>
      
      <div class="calculator-card">
        <form class="calculator-form">
          <div class="form-row">
            <div class="form-field">
              <label for="location" class="form-label">
                Localisation du projet
              </label>
              <select 
                id="location" 
                [(ngModel)]="location"
                name="location"
                class="form-input"
              >
                <option value="Tunis">Tunis</option>
                <option value="Sfax">Sfax</option>
                <option value="Sousse">Sousse</option>
                <option value="Gabès">Gabès</option>
              </select>
            </div>
          </div>
          
          <div class="form-divider">
            <span class="divider-text">OU</span>
          </div>
          
          <div class="form-row-split">
            <div class="form-field">
              <label for="sizeKwp" class="form-label">
                Taille de l'installation (kWp)
              </label>
              <input
                type="number"
                id="sizeKwp"
                [(ngModel)]="installationSizeKwp"
                name="sizeKwp"
                placeholder="Ex: 50"
                class="form-input"
                min="0"
              />
            </div>
            
            <div class="form-field">
              <label for="investmentAmount" class="form-label">
                Budget du projet (DT)
              </label>
              <input
                type="number"
                id="investmentAmount"
                [(ngModel)]="investmentAmountDt"
                name="investmentAmount"
                placeholder="Ex: 150000"
                class="form-input"
                min="0"
              />
            </div>
          </div>
          
          <div class="info-box">
            <ng-icon name="lucideInfo" size="16"></ng-icon>
            <span>Renseignez SOIT la taille en kWp, SOIT le budget en dinars (pas les deux)</span>
          </div>
        </form>
        
        <div class="project-summary">
          <h3 class="text-heading-h4 color-text-primary summary-title">
            Résumé du projet
          </h3>
          <div class="summary-grid">
            <div class="summary-item">
              <span class="summary-label">Taille installation</span>
              <span class="summary-value">{{ sizeKwp() | number:'1.0-1' }} kWp</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Investissement total</span>
              <span class="summary-value">{{ formatCurrency(capexDt()) }}</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Production annuelle</span>
              <span class="summary-value">{{ annualProductionKwh() | number:'1.0-0' }} kWh</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Économies annuelles</span>
              <span class="summary-value">{{ formatCurrency(annualGrossSavingsDt()) }}</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Économies mensuelles</span>
              <span class="summary-value highlight-value">{{ formatCurrency(monthlyGrossSavingsDt()) }}/mois</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Durée de comparaison</span>
              <span class="summary-value">7 ans (84 mois)</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Comparison Results -->
  <section class="comparison-section">
    <div class="container">
      <div class="section-header">
        <span class="section-label">COMPARAISON</span>
        <h2 class="text-heading-h1 color-text-primary">
          Financez votre transition énergétique sans investir
        </h2>
        <p class="color-text-secondary">
          4 solutions sur les mêmes 7 ans et avec les mêmes hypothèses
        </p>
      </div>
      
      <div class="solutions-grid">
        @for (solution of solutions(); track solution.name; let i = $index) {
          <div 
            class="solution-card"
            [class.solution-card-selected]="selectedSolution() === i"
            [class.solution-card-esco]="solution.name === 'ESCO JOYA'"
            (click)="selectSolution(i)"
          >
            <div class="solution-header" [style.border-color]="solution.color">
              <h3 class="text-heading-h3 solution-name" [style.color]="solution.color">
                {{ solution.name }}
              </h3>
              @if (solution.name === 'ESCO JOYA') {
                <span class="recommended-badge">Recommandé</span>
              }
            </div>
            
            <div class="solution-metrics">
              <div class="metric-item">
                <span class="metric-label">Investissement initial</span>
                <span class="metric-value">{{ formatCurrency(solution.initialInvestment) }}</span>
              </div>
              
              <div class="metric-item">
                <span class="metric-label">Mensualité</span>
                <span class="metric-value">{{ formatCurrency(solution.monthlyPayment) }}</span>
              </div>
              
              <div class="metric-item">
                <span class="metric-label">OPEX mensuel</span>
                <span class="metric-value">{{ formatCurrency(solution.monthlyOpex) }}</span>
              </div>
              
              <div class="metric-divider"></div>
              
              <div class="metric-item metric-total">
                <span class="metric-label">Coût mensuel total</span>
                <span class="metric-value">{{ formatCurrency(solution.totalMonthlyCost) }}</span>
              </div>
              
              <div class="metric-item">
                <span class="metric-label">Économies mensuelles</span>
                <span class="metric-value positive">{{ formatCurrency(solution.monthlySavings) }}</span>
              </div>
              
              <div class="metric-divider"></div>
              
              <div class="metric-item metric-highlight">
                <span class="metric-label">Cashflow mensuel</span>
                <span class="metric-value" [class.positive]="solution.monthlyCashflow > 0" [class.negative]="solution.monthlyCashflow < 0">
                  {{ formatCurrency(solution.monthlyCashflow) }}
                </span>
              </div>
            </div>
            
            <div class="solution-footer">
              <span class="duration-label">Durée : 7 ans</span>
            </div>
          </div>
        }
      </div>
    </div>
  </section>

  <!-- Advantages / Disadvantages -->
  @if (selectedSolution() !== null) {
    <section class="details-section">
      <div class="container">
        <div class="details-card">
          <h3 class="text-heading-h2 color-text-primary details-title">
            {{ solutions()[selectedSolution()!].name }} – Avantages & Inconvénients
          </h3>
          
          <div class="details-grid">
            <div class="advantages-column">
              <h4 class="text-heading-h3 column-title">
                <ng-icon name="lucideCheck" size="20" class="icon-success"></ng-icon>
                Avantages
              </h4>
              <ul class="details-list">
                @for (advantage of solutions()[selectedSolution()!].advantages; track advantage) {
                  <li class="detail-item">
                    <ng-icon name="lucideCheck" size="16" class="icon-check"></ng-icon>
                    <span>{{ advantage }}</span>
                  </li>
                }
              </ul>
            </div>
            
            <div class="disadvantages-column">
              <h4 class="text-heading-h3 column-title">
                <ng-icon name="lucideX" size="20" class="icon-error"></ng-icon>
                Inconvénients
              </h4>
              <ul class="details-list">
                @for (disadvantage of solutions()[selectedSolution()!].disadvantages; track disadvantage) {
                  <li class="detail-item">
                    <ng-icon name="lucideX" size="16" class="icon-x"></ng-icon>
                    <span>{{ disadvantage }}</span>
                  </li>
                }
              </ul>
            </div>
          </div>
          
          <div class="details-cta">
            <a href="/contact" class="btn btn-primary btn-lg">
              Parler à un conseiller
            </a>
          </div>
        </div>
      </div>
    </section>
  }

  <!-- ESCO Explanation -->
  <section class="esco-section">
    <div class="container">
      <div class="esco-content">
        <div class="esco-text">
          <span class="section-label">MODÈLE ESCO</span>
          <h2 class="text-heading-h1 color-text-primary">
            C'est quoi les ESCo ?
          </h2>
          <p class="color-text-secondary esco-description">
            Les ESCo (Energy Service Company) sont des entreprises qui financent, installent et maintiennent votre installation solaire. Vous ne payez qu'une partie des économies réalisées, sans aucun investissement initial.
          </p>
          
          <div class="esco-features">
            <div class="feature-item">
              <div class="feature-icon">✓</div>
              <div>
                <h4 class="text-heading-h5 color-text-primary">0€ d'investissement</h4>
                <p class="color-text-secondary">JOYA finance 100% de votre installation</p>
              </div>
            </div>
            
            <div class="feature-item">
              <div class="feature-icon">✓</div>
              <div>
                <h4 class="text-heading-h5 color-text-primary">Maintenance incluse</h4>
                <p class="color-text-secondary">JOYA s'occupe de tout pendant 7 ans</p>
              </div>
            </div>
            
            <div class="feature-item">
              <div class="feature-icon">✓</div>
              <div>
                <h4 class="text-heading-h5 color-text-primary">Gain immédiat</h4>
                <p class="color-text-secondary">Cashflow positif dès le premier mois</p>
              </div>
            </div>
          </div>
          
          <a href="/modele-esco" class="btn btn-secondary">
            En savoir plus sur le modèle ESCo
          </a>
        </div>
        
        <div class="esco-visual">
          <div class="esco-diagram">
            <div class="diagram-item">
              <div class="diagram-label">Installation</div>
              <div class="diagram-bar" style="background: #0a3d46;">
                <span class="bar-label">FACTURE 100%</span>
                <span class="bar-sublabel">JOYA finance 100%, vous payez 0%</span>
              </div>
            </div>
            
            <div class="diagram-item">
              <div class="diagram-label">Contrat</div>
              <div class="diagram-bar split-bar">
                <div class="bar-part" style="background: #f3a31c; flex: 0.3;">
                  <span class="bar-label">ÉCONOMIES 30%</span>
                </div>
                <div class="bar-part" style="background: #22c55e; flex: 0.7;">
                  <span class="bar-label">PART ESCo 70%</span>
                </div>
              </div>
              <span class="bar-sublabel">Économisez dès le 1er jour</span>
            </div>
            
            <div class="diagram-item">
              <div class="diagram-label">Fin contrat</div>
              <div class="diagram-bar" style="background: #22c55e;">
                <span class="bar-label">ÉCONOMIES 100%</span>
                <span class="bar-sublabel">Installation 100% à vous en fin de contrat</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="cta-section">
    <div class="container">
      <div class="cta-card">
        <h2 class="text-heading-h1 color-text-inverse cta-title">
          Prêt à passer au solaire sans investir ?
        </h2>
        <p class="cta-subtitle">
          Parlons de votre projet et trouvons ensemble la meilleure solution de financement
        </p>
        <div class="cta-buttons">
          <a href="/contact" class="btn btn-primary btn-lg">
            Parler à un conseiller
          </a>
          <a href="/audit-solaire" class="btn btn-secondary btn-lg">
            Faire une simulation
          </a>
        </div>
      </div>
    </div>
  </section>
</div>


