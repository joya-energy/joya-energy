<div class="financing-form">
  <h2>Comparez vos options de financement</h2>
  
  @if (error()) {
    <div class="error-message">{{ error() }}</div>
  }

  <form (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="location">Localisation du projet *</label>
      <select 
        id="location" 
        [value]="location()"
        (change)="onLocationChange($any($event.target).value)"
        required>
        <option value="">SÃ©lectionnez une ville</option>
        @for (loc of locations(); track loc.location) {
          <option [value]="loc.location">
            {{ loc.location }} ({{ loc.yieldKwhPerKwpYear }} kWh/kWp/an)
          </option>
        }
      </select>
    </div>

    <div class="form-group">
      <label>Type de saisie</label>
      <div class="radio-group">
        <label>
          <input 
            type="radio" 
            name="inputType" 
            [checked]="inputType() === 'size'"
            (change)="onInputTypeChange('size')">
          Taille de l'installation (kWp)
        </label>
        <label>
          <input 
            type="radio" 
            name="inputType" 
            [checked]="inputType() === 'amount'"
            (change)="onInputTypeChange('amount')">
          Budget d'investissement (DT)
        </label>
      </div>
    </div>

    @if (inputType() === 'size') {
      <div class="form-group">
        <label for="size">Taille de l'installation (kWp) *</label>
        <input 
          type="number" 
          id="size"
          [value]="installationSize() ?? ''"
          (input)="onInstallationSizeChange($any($event.target).valueAsNumber)"
          min="1"
          step="0.1"
          placeholder="Ex: 50"
          required>
      </div>
    }

    @if (inputType() === 'amount') {
      <div class="form-group">
        <label for="amount">Budget d'investissement (DT) *</label>
        <input 
          type="number" 
          id="amount"
          [value]="investmentAmount() ?? ''"
          (input)="onInvestmentAmountChange($any($event.target).valueAsNumber)"
          min="1"
          step="1000"
          placeholder="Ex: 125000"
          required>
      </div>
    }

    <button 
      type="submit" 
      [disabled]="!isValid() || loading()"
      class="btn-primary">
      @if (loading()) {
        <span>Calcul en cours...</span>
      } @else {
        <span>Comparer les solutions</span>
      }
    </button>
  </form>
</div>

